{"compress":true,"commitItems":[["fe3d92e9-6840-41ac-962e-b2da62556c44",1559721428395,"",[[1559721417994,["david@DESKTOP-HUOM822",[[1,0,"# ngxin做http强制跳转https，接口的POST请求变成了GET\n\n[![](https://s3.51cto.com/wyfs02/M00/77/FA/wKiom1Zyb9GQumB1AAAwBlCKQH8799_middle.jpg)](https://blog.51cto.com/10309478)\n\n[我值得拥有](https://blog.51cto.com/10309478)0人评论[29021人阅读](javascript:;)[2018-03-20 17:13:13](javascript:;)\n\n公司准备将 http 换成 https，就需要 http 强制跳转到 https。这个在网上搜了下，基本总结下\n\n在 server 里面配置 `rewrite ^(.*)$  https:``//``$host$1 permanent;`\n\n或者在server里面配置 `return ``301 https:``//``$server_name$request_uri;`\n\n`或者在server里面配 if，这里指的是需要配置多个域名`\n\n``if` `($host ~* ``\"^wangshibo.com$\"``) {``\n\n``    rewrite ^/(.*)$ https:``//dev``.wangshibo.com/ permanent;``\n\n``}``\n\n或者在server里面配置  `error_page 497  https:``//``$host$uri?$args;`\n\n基本就上面这几种方法，网站访问是没问题的，跳转也是ok的\n\n配置成功之后，准备把APP接口的地址也换成https，这就遇到问题了\n\n排查原因发现，首先GET请求是可以收到信息的，POST传参过去是没有信息，我在nginx日志里面配置了$request_body，日志里面发现确实是没有带参数进来，查看日志的前面，POST却变成了GET。找到了问题的关键\n\n通过网上查资料，发现是由于 301引起的。换成307问题解决。\n\n301 Moved Permanently\n被请求的资源已永久移动到新位置，并且将来任何对此资源的引用都应该使用本响应返回的若干个 URI 之一\n\n307 Temporary Redirect\n请求的资源现在临时从不同的URI 响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求 \n\n从上面我们可以看出，301跳转是永久重定向，而307是临时重定向。这就是301跳转与307跳转两者之间的区别 \n\n上面可能看的不是很懂，简单直白的表述一下区别：\n\nreturn 307 https://$server_name$request_uri; \n\n307：对于 POST 请求，表示请求还没有被处理，客户端应该向 Location 里的 URI 重新发起 POST 请求\n\n换成 307 状态码即可强制要求不能更改之前的方法。 \n\n下面配置80与443共存：\n\n需要配置在一个server里面，443端口后面加ssl。注释掉 ssl on;，具体如下：\n\n```bash\nserver{\n        listen 80;\n        listen 443 ssl;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        #ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n两个server的写法：\n\n```bash\nserver{\n        listen 80;\n        server_name testapp.***.com;\n        rewrite ^(.*) https://$server_name$1 permanent;\n}\n\nserver{\n        listen 443;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n献上ssl优化，以下可以根据业务来使用，不必全部配置，一般配置红色的部分就行了\n\nssl on;\n\n`ssl_certificate   /usr/local/https/www.localhost.com.crt;`\n\n`ssl_certificate_key  /usr/local/https/www.localhost.com.key;`\n\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;  #只允许TLS协议\nssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;#加密套件,这里用了CloudFlare's Internet facing SSL cipher configuration\nssl_prefer_server_ciphers on;  #由服务器协商最佳的加密算法\n\nssl_session_cache builtin:1000 shared:SSL:10m;#Session Cache，将Session缓存到服务器，这可能会占用更多的服务器资源\nssl_session_tickets on;  #开启浏览器的Session Ticket缓存\nssl_session_timeout 10m;  #SSL session过期时间\nssl_stapling on; #OCSP Stapling开启,OCSP是用于在线查询证书吊销情况的服务，使用OCSP Stapling能将证书有效状态的信息缓存到服务器，提高TLS握手速度\nssl_stapling_verify on;  #OCSP Stapling验证开启\nresolver 8.8.8.8 8.8.4.4 valid=300s;  #用于查询OCSP服务器的\nDNSresolver_timeout 5s;  #查询域名超时时间"]],[0,0],[4346,4346]]]],null,"david@DESKTOP-HUOM822"],["3428884f-35aa-41fc-b693-5e79d9d70927",1559729046400,"# ngxin做http强制跳转https，接口的POST请求变成了GET\n\n[![](https://s3.51cto.com/wyfs02/M00/77/FA/wKiom1Zyb9GQumB1AAAwBlCKQH8799_middle.jpg)](https://blog.51cto.com/10309478)\n\n[我值得拥有](https://blog.51cto.com/10309478)0人评论[29021人阅读](javascript:;)[2018-03-20 17:13:13](javascript:;)\n\n公司准备将 http 换成 https，就需要 http 强制跳转到 https。这个在网上搜了下，基本总结下\n\n在 server 里面配置 `rewrite ^(.*)$  https:``//``$host$1 permanent;`\n\n或者在server里面配置 `return ``301 https:``//``$server_name$request_uri;`\n\n`或者在server里面配 if，这里指的是需要配置多个域名`\n\n``if` `($host ~* ``\"^wangshibo.com$\"``) {``\n\n``    rewrite ^/(.*)$ https:``//dev``.wangshibo.com/ permanent;``\n\n``}``\n\n或者在server里面配置  `error_page 497  https:``//``$host$uri?$args;`\n\n基本就上面这几种方法，网站访问是没问题的，跳转也是ok的\n\n配置成功之后，准备把APP接口的地址也换成https，这就遇到问题了\n\n排查原因发现，首先GET请求是可以收到信息的，POST传参过去是没有信息，我在nginx日志里面配置了$request_body，日志里面发现确实是没有带参数进来，查看日志的前面，POST却变成了GET。找到了问题的关键\n\n通过网上查资料，发现是由于 301引起的。换成307问题解决。\n\n301 Moved Permanently\n被请求的资源已永久移动到新位置，并且将来任何对此资源的引用都应该使用本响应返回的若干个 URI 之一\n\n307 Temporary Redirect\n请求的资源现在临时从不同的URI 响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求 \n\n从上面我们可以看出，301跳转是永久重定向，而307是临时重定向。这就是301跳转与307跳转两者之间的区别 \n\n上面可能看的不是很懂，简单直白的表述一下区别：\n\nreturn 307 https://$server_name$request_uri; \n\n307：对于 POST 请求，表示请求还没有被处理，客户端应该向 Location 里的 URI 重新发起 POST 请求\n\n换成 307 状态码即可强制要求不能更改之前的方法。 \n\n下面配置80与443共存：\n\n需要配置在一个server里面，443端口后面加ssl。注释掉 ssl on;，具体如下：\n\n```bash\nserver{\n        listen 80;\n        listen 443 ssl;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        #ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n两个server的写法：\n\n```bash\nserver{\n        listen 80;\n        server_name testapp.***.com;\n        rewrite ^(.*) https://$server_name$1 permanent;\n}\n\nserver{\n        listen 443;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n献上ssl优化，以下可以根据业务来使用，不必全部配置，一般配置红色的部分就行了\n\nssl on;\n\n`ssl_certificate   /usr/local/https/www.localhost.com.crt;`\n\n`ssl_certificate_key  /usr/local/https/www.localhost.com.key;`\n\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;  #只允许TLS协议\nssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;#加密套件,这里用了CloudFlare's Internet facing SSL cipher configuration\nssl_prefer_server_ciphers on;  #由服务器协商最佳的加密算法\n\nssl_session_cache builtin:1000 shared:SSL:10m;#Session Cache，将Session缓存到服务器，这可能会占用更多的服务器资源\nssl_session_tickets on;  #开启浏览器的Session Ticket缓存\nssl_session_timeout 10m;  #SSL session过期时间\nssl_stapling on; #OCSP Stapling开启,OCSP是用于在线查询证书吊销情况的服务，使用OCSP Stapling能将证书有效状态的信息缓存到服务器，提高TLS握手速度\nssl_stapling_verify on;  #OCSP Stapling验证开启\nresolver 8.8.8.8 8.8.4.4 valid=300s;  #用于查询OCSP服务器的\nDNSresolver_timeout 5s;  #查询域名超时时间",[[1559728996955,["david@DESKTOP-HUOM822",[[-1,39,"[![](https://s3.51cto.com/wyfs02/M00/77/FA/wKiom1Zyb9GQumB1AAAwBlCKQH8799_middle.jpg)](https://blog.51cto.com/10309478)\n\n[我值得拥有](https://blog.51cto.com/10309478)0人评论[29021人阅读](javascript:;)[2018-03-20 17:13:13](javascript:;)\n"]],[39,264],[39,39]]],[1559729030669,["david@DESKTOP-HUOM822",[[-1,40,"公司准备将 http 换成 https，就需要 http 强制跳转到 https。这个在网上搜了下，基本总结下\n\n在 server 里面配置 `rewrite ^(.*)$  https:``//``$host$1 permanent;`\n\n或者在server里面配置 `return ``301 https:``//``$server_name$request_uri;`\n\n`或者在server里面配 if，这里指的是需要配置多个域名`\n\n``if` `($host ~* ``\"^wangshibo.com$\"``) {``\n\n``    rewrite ^/(.*)$ https:``//dev``.wangshibo.com/ permanent;``\n\n``}``\n\n或者在server里面配置  `error_page 497  https:``//``$host$uri?$args;`\n\n基本就上面这几种方法，网站访问是没问题的，跳转也是ok的"]],[40,472],[40,40]]],[1559729034257,["david@DESKTOP-HUOM822",[[1,40,"公司准备将 http 换成 https，就需要 http 强制跳转到 https。这个在网上搜了下，基本总结下\n\n在 server 里面配置 `rewrite ^(.*)$  https:``//``$host$1 permanent;`\n\n或者在server里面配置 `return ``301 https:``//``$server_name$request_uri;`\n\n`或者在server里面配 if，这里指的是需要配置多个域名`\n\n``if` `($host ~* ``\"^wangshibo.com$\"``) {``\n\n``    rewrite ^/(.*)$ https:``//dev``.wangshibo.com/ permanent;``\n\n``}``\n\n或者在server里面配置  `error_page 497  https:``//``$host$uri?$args;`\n\n基本就上面这几种方法，网站访问是没问题的，跳转也是ok的"]],[40,40],[40,472]]],[1559729039875,["david@DESKTOP-HUOM822",[[-1,40,"公司准备将 http 换成 https，就需要 http 强制跳转到 https。这个在网上搜了下，基本总结下\n\n在 server 里面配置 `rewrite ^(.*)$  https:``//``$host$1 permanent;`\n\n或者在server里面配置 `return ``301 https:``//``$server_name$request_uri;`\n\n`或者在server里面配 if，这里指的是需要配置多个域名`\n\n``if` `($host ~* ``\"^wangshibo.com$\"``) {``\n\n``    rewrite ^/(.*)$ https:``//dev``.wangshibo.com/ permanent;``\n\n``}``\n\n或者在server里面配置  `error_page 497  https:``//``$host$uri?$args;`\n\n基本就上面这几种方法，网站访问是没问题的，跳转也是ok的"]],[40,472],[40,40]]],[1559729041604,["david@DESKTOP-HUOM822",[[-1,41,"\n"]],[41,41],[40,40]]],[1559729041803,["david@DESKTOP-HUOM822",[[-1,40,"\n"]],[40,40],[39,39]]],[1559729042315,["david@DESKTOP-HUOM822",[[-1,39,"\n"]],[39,39],[38,38]]],[1559729054524,["david@DESKTOP-HUOM822",[[-1,0,"# ngxin做http强制跳转https，接口的POST请求变成了GET"],[1,37,"\n"]],[0,37],[1,1]]],[1559729055819,["david@DESKTOP-HUOM822",[[1,0,"# ngxin做http强制跳转https，接口的POST请求变成了GET"],[-1,0,"\n"]],[1,1],[0,37]]],[1559729057045,["david@DESKTOP-HUOM822",[[1,0,"\n"]],[0,0],[1,1]]],[1559729057916,["david@DESKTOP-HUOM822",[[1,0,"---\ntitle: windows/mac下图床神器\ncategories: 工具\n\ntags:\n- 图床神器\n---"]],[0,0],[60,60]]],[1559729058292,["david@DESKTOP-HUOM822",[[1,61,"\n"]],[60,60],[61,61]]],[1559729062164,["david@DESKTOP-HUOM822",[[-1,11,"windows/mac下图床神器"]],[11,27],[11,11]]],[1559729076030,["david@DESKTOP-HUOM822",[[1,11,"N"],[-1,2953," "],[1,2954," "],[-1,3017," "],[1,3018," "],[-1,3074," "],[1,3075," "],[-1,3080," "],[1,3081," "],[-1,3088," "],[1,3089," "],[-1,3097,"  "],[1,3099,"  "],[-1,3120," "],[1,3121," "],[-1,3232," "],[1,3233," "],[-1,3241," "],[1,3242," "],[-1,3248," SSL "],[1,3253," SSL "],[-1,3259," "],[1,3260," "],[-1,3299," on;  "],[1,3305," on;  "],[-1,3338," "],[1,3339," "],[-1,3351," "],[1,3352," "],[-1,3375," "],[1,3376," "],[-1,3431," on;  "],[1,3437," on;  "],[-1,3451," "],[1,3452," "],[-1,3480," "],[1,3481," "],[-1,3485,"  "],[1,3487,"  "],[-1,3491," "],[1,3492," "],[-1,3516," on; "],[1,3521," on; "],[-1,3526," "],[1,3527," "],[-1,3565," "],[1,3566," "],[-1,3621," on;  "],[1,3627," on;  "],[-1,3632," "],[1,3633," "],[-1,3654," "],[1,3655," "],[-1,3662," "],[1,3663," "],[-1,3670," "],[1,3671," "],[-1,3682,"  "],[1,3684,"  "],[-1,3717," 5s;  "],[1,3723," 5s;  ginx配置Https证书后"]],[11,11],[26,26]]],[1559729077523,["david@DESKTOP-HUOM822",[[-1,25,"后"]],[26,26],[25,25]]],[1559729092022,["david@DESKTOP-HUOM822",[[1,25,"后接口POST请求变为GET请求"]],[25,25],[41,41]]],[1559729098147,["david@DESKTOP-HUOM822",[[-1,54,"工具"]],[56,56],[54,54]]],[1559729100880,["david@DESKTOP-HUOM822",[[1,54,"Nginx"]],[54,54],[59,59]]],[1559729103419,["david@DESKTOP-HUOM822",[[-1,69,"图床神器"]],[73,73],[69,69]]],[1559729104604,["david@DESKTOP-HUOM822",[[1,69,"https"]],[69,69],[74,74]]],[1559729165327,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,41,"具\n\ntag"],[1,47,"\ncategorie"],[-1,49,"\n-"],[-1,52,"图床"],[1,60,"\ntags:\n- https\n"],[-1,69,"https"],[1,74,"xin做"],[-1,3743,"ginx配置Https证书后"]],[12,12],[3743,3743]]],[1559729165327,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,41,"具\n\ntag"],[-1,41,"\ncategorie"],[1,53,"\n-"],[1,54,"图床"],[-1,60,"\ntags:\n- https\n"],[1,84,"https"],[-1,84,"xin做"],[1,3757,"ginx配置Https证书后"]],[3743,3743],[12,12]]],[1559729107627,["david@DESKTOP-HUOM822",[[-1,80,"# ngxin做http强制跳转https，接口的POST请求变成了GET"]],[80,117],[80,80]]],[1559729108356,["david@DESKTOP-HUOM822",[[-1,81,"\n"]],[80,80],[79,79]]],[1559729114572,["david@DESKTOP-HUOM822",[[-1,26,"接口"]],[28,28],[26,26]]],[1559729115670,["david@DESKTOP-HUOM822",[[1,26,"a"]],[26,26],[27,27]]],[1559729116092,["david@DESKTOP-HUOM822",[[-1,26,"a"]],[27,27],[26,26]]],[1559729121865,["david@DESKTOP-HUOM822",[[1,26,",项目访问"]],[26,26],[31,31]]],[1559729122421,["david@DESKTOP-HUOM822",[[-1,29,"访问"]],[31,31],[29,29]]],[1559729124704,["david@DESKTOP-HUOM822",[[1,29,"API接口"]],[29,29],[34,34]]],[1559729126572,["david@DESKTOP-HUOM822",[[-1,27,"项目API接口"]],[34,34],[27,27]]],[1559729133895,["david@DESKTOP-HUOM822",[[1,27,"API项目访问时"]],[27,27],[35,35]]],[1559729155286,["david@DESKTOP-HUOM822",[[1,87,"Nginx下配置Http转Https调整"]],[87,87],[107,107]]],[1559729155917,["david@DESKTOP-HUOM822",[[-1,105,"调整"]],[107,107],[105,105]]],[1559729162517,["david@DESKTOP-HUOM822",[[1,105,"跳转可以参考[]"]],[105,105],[113,113]]],[1559729163389,["david@DESKTOP-HUOM822",[[-1,111,"[]"]],[113,113],[111,111]]],[1559729225330,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[1,111,"\n配置成功之后，准备把A"],[1,112,"P接"],[-1,3736,"ginx配置Https证书后"]],[12,12],[3736,3736]]],[1559729225330,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[-1,111,"\n配置成功之后，准备把A"],[-1,124,"P接"],[1,3750,"ginx配置Https证书后"]],[3736,3736],[12,12]]],[1559729169348,["david@DESKTOP-HUOM822",[[1,112,"\n"]],[111,111],[112,112]]],[1559729169532,["david@DESKTOP-HUOM822",[[1,113,"\n"]],[112,112],[113,113]]],[1559729175195,["david@DESKTOP-HUOM822",[[-1,140,"，这就遇到问题了"]],[148,148],[140,140]]],[1559729176265,["david@DESKTOP-HUOM822",[[1,140,"，"]],[140,140],[141,141]]],[1559729176947,["david@DESKTOP-HUOM822",[[-1,140,"，"]],[141,141],[140,140]]],[1559729180414,["david@DESKTOP-HUOM822",[[1,140,", 遇到了问题"]],[140,140],[147,147]]],[1559729186043,["david@DESKTOP-HUOM822",[[-1,145,"问题"]],[147,147],[145,145]]],[1559729186990,["david@DESKTOP-HUOM822",[[1,145,"后台"]],[145,145],[147,147]]],[1559729187667,["david@DESKTOP-HUOM822",[[-1,145,"后台"]],[147,147],[145,145]]],[1559729191069,["david@DESKTOP-HUOM822",[[1,145,"springboo"]],[145,145],[154,154]]],[1559729192628,["david@DESKTOP-HUOM822",[[-1,145,"springboo"]],[154,154],[145,145]]],[1559729193061,["david@DESKTOP-HUOM822",[[1,145,"s"]],[145,145],[146,146]]],[1559729193565,["david@DESKTOP-HUOM822",[[-1,145,"s"]],[146,146],[145,145]]],[1559729194340,["david@DESKTOP-HUOM822",[[1,145,"xiangm"]],[145,145],[151,151]]],[1559729195420,["david@DESKTOP-HUOM822",[[-1,145,"xiangm"]],[151,151],[145,145]]],[1559729199048,["david@DESKTOP-HUOM822",[[1,145,"项目异常的问题"]],[145,145],[152,152]]],[1559729219925,["david@DESKTOP-HUOM822",[[1,121,"admin项目可以正常跳转到HTTPS, "]],[121,121],[142,142]]],[1559729285331,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[-1,114,"口的地址也换成"],[1,121,"\n配置成功之后，"],[1,142,"准备把APP接口的地址也换成"],[-1,147,"，这就遇到问题了\n\n排查原因"],[1,173,"\n\n排查原因发现，首先GET"],[-1,3763,"ginx配置Https证书后"]],[12,12],[3763,3763]]],[1559729285331,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[1,113,"口的地址也换成"],[-1,113,"\n配置成功之后，"],[-1,142,"准备把APP接口的地址也换成"],[1,161,"，这就遇到问题了\n\n排查原因"],[-1,173,"\n\n排查原因发现，首先GET"],[1,3777,"ginx配置Https证书后"]],[3763,3763],[12,12]]],[1559729227852,["david@DESKTOP-HUOM822",[[1,175,"\n"]],[173,173],[174,174]]],[1559729228044,["david@DESKTOP-HUOM822",[[1,176,"\n"]],[174,174],[175,175]]],[1559729228875,["david@DESKTOP-HUOM822",[[-1,176,"\n"]],[175,175],[174,174]]],[1559729229027,["david@DESKTOP-HUOM822",[[-1,175,"\n"]],[174,174],[173,173]]],[1559729230317,["david@DESKTOP-HUOM822",[[-1,168,"异常的问题"]],[173,173],[168,168]]],[1559729231205,["david@DESKTOP-HUOM822",[[1,168,"YUI"]],[168,168],[171,171]]],[1559729231948,["david@DESKTOP-HUOM822",[[-1,168,"YUI"]],[171,171],[168,168]]],[1559729234967,["david@DESKTOP-HUOM822",[[1,168,"异常，"]],[168,168],[171,171]]],[1559729235701,["david@DESKTOP-HUOM822",[[-1,170,"，"]],[171,171],[170,170]]],[1559729236128,["david@DESKTOP-HUOM822",[[1,170,"，"]],[170,170],[171,171]]],[1559729236661,["david@DESKTOP-HUOM822",[[-1,170,"，"]],[171,171],[170,170]]],[1559729242151,["david@DESKTOP-HUOM822",[[1,170,",查看日志"]],[170,170],[175,175]]],[1559729242837,["david@DESKTOP-HUOM822",[[-1,173,"日志"]],[175,175],[173,173]]],[1559729244390,["david@DESKTOP-HUOM822",[[1,173,"NGIN"]],[173,173],[177,177]]],[1559729245020,["david@DESKTOP-HUOM822",[[-1,174,"GIN"]],[177,177],[174,174]]],[1559729248286,["david@DESKTOP-HUOM822",[[1,174,"ginx后"]],[174,174],[179,179]]],[1559729250660,["david@DESKTOP-HUOM822",[[-1,178,"后"]],[179,179],[178,178]]],[1559729265071,["david@DESKTOP-HUOM822",[[1,178,"日志后发现跳转"]],[178,178],[185,185]]],[1559729266188,["david@DESKTOP-HUOM822",[[-1,183,"跳转"]],[185,185],[183,183]]],[1559729276214,["david@DESKTOP-HUOM822",[[1,183,"从http跳转到https时，"]],[183,183],[198,198]]],[1559729277412,["david@DESKTOP-HUOM822",[[-1,197,"，"]],[198,198],[197,197]]],[1559729285118,["david@DESKTOP-HUOM822",[[1,197,",请求的api方法从"]],[197,197],[207,207]]],[1559729346172,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[-1,114,"口的地址也换成"],[1,121,"\n配置成功之后，"],[1,142,"准备把APP接口的地址也换成"],[-1,147,"，这就遇到问题了\n\n排查原因"],[1,207,"\n\n排查原因发现，首先GET"],[-1,3797,"ginx配置Https证书后"]],[12,12],[3797,3797]]],[1559729346172,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[1,113,"口的地址也换成"],[-1,113,"\n配置成功之后，"],[-1,142,"准备把APP接口的地址也换成"],[1,161,"，这就遇到问题了\n\n排查原因"],[-1,207,"\n\n排查原因发现，首先GET"],[1,3811,"ginx配置Https证书后"]],[3797,3797],[12,12]]],[1559729289447,["david@DESKTOP-HUOM822",[[1,207,"GET变为了"]],[207,207],[213,213]]],[1559729295203,["david@DESKTOP-HUOM822",[[-1,207,"GET"]],[210,210],[207,207]]],[1559729297933,["david@DESKTOP-HUOM822",[[1,207,"POST"]],[207,207],[211,211]]],[1559729305748,["david@DESKTOP-HUOM822",[[1,214,"GET请求，日志如下:"]],[214,214],[225,225]]],[1559729306107,["david@DESKTOP-HUOM822",[[1,227,"\n"]],[225,225],[226,226]]],[1559729307971,["david@DESKTOP-HUOM822",[[1,228,"\n"]],[226,226],[227,227]]],[1559729308965,["david@DESKTOP-HUOM822",[[1,227,"```"]],[227,227],[230,230]]],[1559729309763,["david@DESKTOP-HUOM822",[[1,232,"\n"]],[230,230],[231,231]]],[1559729310391,["david@DESKTOP-HUOM822",[[1,231,"```"]],[231,231],[234,234]]],[1559729311235,["david@DESKTOP-HUOM822",[[1,231,"\n"]],[230,230],[231,231]]],[1559729527174,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[-1,114,"口的地址也换成"],[1,121,"\n配置成功之后，"],[1,142,"准备把APP接口的地址也换成"],[-1,147,"，这就遇到问题了\n\n排查原因"],[-1,225,"请求"],[1,227,"\n\n"],[1,237,"排查原因发现，首先GET请求"],[-1,3825,"ginx配置Https证书后"]],[12,12],[3825,3825]]],[1559729527174,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[1,113,"口的地址也换成"],[-1,113,"\n配置成功之后，"],[-1,142,"准备把APP接口的地址也换成"],[1,161,"，这就遇到问题了\n\n排查原因"],[1,225,"请求"],[-1,225,"\n\n"],[-1,237,"排查原因发现，首先GET请求"],[1,3839,"ginx配置Https证书后"]],[3825,3825],[12,12]]],[1559729507707,["david@DESKTOP-HUOM822",[[1,231,"123.52.42.83 - - [05/Jun/2019:15:51:46 +0800] \"POST /ylzhy-api/api/wechat/user/login HTTP/1.1\" 301 185 \"-\" \"PostmanRuntime/7.13.0\"\n123.52.42.83 - - [05/Jun/2019:15:51:46 +0800] \"GET /ylzhy-api/api/wechat/user/login HTTP/1.1\" 200 65 \"http://www.sjjtcloud.com:80/ylzhy-api/api/wechat/user/login\" \"PostmanRuntime/7.13.0\""]],[231,231],[548,548]]],[1559729517708,["david@DESKTOP-HUOM822",[[1,362,"\n"]],[361,361],[362,362]]],[1559729587176,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[-1,114,"口的地址也换成"],[1,121,"\n配置成功之后，"],[1,142,"准备把APP接口的地址也换成"],[-1,147,"，这就遇到问题了\n\n排查原因"],[-1,225,"请求"],[1,227,"\n\n"],[1,555,"排查原因发现，首先GET请求"],[-1,4143,"ginx配置Https证书后"]],[12,12],[4143,4143]]],[1559729587176,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[1,113,"口的地址也换成"],[-1,113,"\n配置成功之后，"],[-1,142,"准备把APP接口的地址也换成"],[1,161,"，这就遇到问题了\n\n排查原因"],[1,225,"请求"],[-1,225,"\n\n"],[-1,555,"排查原因发现，首先GET请求"],[1,4157,"ginx配置Https证书后"]],[4143,4143],[12,12]]],[1559729539787,["david@DESKTOP-HUOM822",[[-1,555,"排查原因发现，首先GET请求是可以收到信息的，POST传参过去是没有信息，我在nginx日志里面配置了$request_body，日志里面发现确实是没有带参数进来，查看日志的前面，POST却变成了GET。找到了问题的关键"]],[555,665],[555,555]]],[1559729540373,["david@DESKTOP-HUOM822",[[1,555,"tong"]],[555,555],[559,559]]],[1559729541020,["david@DESKTOP-HUOM822",[[-1,556,"ong"]],[559,559],[556,556]]],[1559729545827,["david@DESKTOP-HUOM822",[[-1,114,"配置成功之后，"]],[114,121],[114,114]]],[1559729549205,["david@DESKTOP-HUOM822",[[1,119,"mo"]],[119,119],[121,121]]],[1559729549851,["david@DESKTOP-HUOM822",[[-1,119,"mo"]],[121,121],[119,119]]],[1559729551085,["david@DESKTOP-HUOM822",[[1,119,"模块"]],[119,119],[121,121]]],[1559729553555,["david@DESKTOP-HUOM822",[[-1,121,"项目"]],[123,123],[121,121]]],[1559729559297,["david@DESKTOP-HUOM822",[[-1,135,"准备把APP接口的地址也换成https"]],[154,154],[135,135]]],[1559729566738,["david@DESKTOP-HUOM822",[[1,135,"API模块部署后"]],[135,135],[143,143]]],[1559729574251,["david@DESKTOP-HUOM822",[[-1,144," 遇到了项目异常"]],[152,152],[144,144]]],[1559729582054,["david@DESKTOP-HUOM822",[[1,144,"后台请求登录遇到异常"]],[144,144],[154,154]]],[1559729647178,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,540,"\n\n通过网上查资料，发现是由"],[-1,4018,"ginx配置Https证书后"]],[12,12],[4018,4018]]],[1559729647178,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,540,"\n\n通过网上查资料，发现是由"],[1,4032,"ginx配置Https证书后"]],[4018,4018],[12,12]]],[1559729589051,["david@DESKTOP-HUOM822",[[-1,539,"t"]],[540,540],[539,539]]],[1559729592331,["david@DESKTOP-HUOM822",[[-1,540,"\n"]],[541,541],[540,540]]],[1559729592580,["david@DESKTOP-HUOM822",[[-1,539,"\n"]],[540,540],[539,539]]],[1559729626932,["david@DESKTOP-HUOM822",[[1,572,"\n"]],[570,570],[571,571]]],[1559729627099,["david@DESKTOP-HUOM822",[[1,573,"\n"]],[571,571],[572,572]]],[1559729629069,["david@DESKTOP-HUOM822",[[1,572,"代码"]],[572,572],[574,574]]],[1559729630307,["david@DESKTOP-HUOM822",[[-1,572,"代码"]],[574,574],[572,572]]],[1559729630467,["david@DESKTOP-HUOM822",[[-1,573,"\n"]],[572,572],[571,571]]],[1559729631956,["david@DESKTOP-HUOM822",[[1,571,"111"]],[571,571],[574,574]]],[1559729632675,["david@DESKTOP-HUOM822",[[-1,571,"111"]],[574,574],[571,571]]],[1559729633139,["david@DESKTOP-HUOM822",[[1,573,"\n"]],[571,571],[572,572]]],[1559729634454,["david@DESKTOP-HUOM822",[[1,572,"··"]],[572,572],[574,574]]],[1559729635195,["david@DESKTOP-HUOM822",[[-1,572,"··"]],[574,574],[572,572]]],[1559729636238,["david@DESKTOP-HUOM822",[[1,572,"```"]],[572,572],[575,575]]],[1559729636819,["david@DESKTOP-HUOM822",[[1,577,"\n"]],[575,575],[576,576]]],[1559729637622,["david@DESKTOP-HUOM822",[[1,576,"```"]],[576,576],[579,579]]],[1559729638420,["david@DESKTOP-HUOM822",[[1,576,"\n"]],[575,575],[576,576]]],[1559729707178,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,539,"通过网上查资料，发现是由于 "],[1,558,"```\n\n```\n\n"],[-1,572,"```\n\n```\n\n"],[-1,4025,"ginx配置Https证书后"]],[12,12],[4025,4025]]],[1559729707178,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,539,"通过网上查资料，发现是由于 "],[-1,572,"```\n\n```\n\n"],[1,596,"```\n\n```\n\n"],[1,4039,"ginx配置Https证书后"]],[4025,4025],[12,12]]],[1559729694957,["david@DESKTOP-HUOM822",[[1,576,"http {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    \n\tserver {\n\t\tlisten 443;\n\t\tserver_name www.sjjtcloud.com;\n\t\tssl on;\n\t\tssl_certificate  \tcert/2195340_www.sjjtcloud.com.pem;\n\t\tssl_certificate_key \tcert/2195340_www.sjjtcloud.com.key;\n\t\tssl_session_timeout 5m;\n\t\tssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n\t\tssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n\t\tssl_prefer_server_ciphers on;\n\n\t\tproxy_set_header Host $host;\n\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\n\t\tlocation / {\n\t\t\tproxy_set_header Host $host;\n\t\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\troot   D:/nginx-1.12.2/html;\n\t\t\tindex  index.html index.htm;\n\t\t\ttry_files $uri $uri/ @router;\n\t\t}\n\t\n\n\t\n\t\tlocation /ylzhy-api/api/ {\n\t\t\tproxy_set_header Host $host;\n\t\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\t\t\tproxy_pass http://127.0.0.1:8081;\n\t\t\t\n\n\t\t}\n\t\t\n\t\tlocation /admin {\n\t\t\tproxy_set_header Host $host;\n\t\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\t\t\tproxy_pass http://127.0.0.1:8083/admin;\n\t\t}\n\t\n\t}\n\n\t\n\t server {\n    \tlisten   80;\n\t\tserver_name www.sjjtcloud.com sjjtcloud.com;  \n\t\tproxy_set_header Host $host;\n\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t#rewrite ^(.*)$  https://${server_name}$1 permanent; \n\t\t#rewrite ^(.*)$  https://$host$1 permanent;\n\t\treturn 307 https://$server_name$request_uri;\n\n\n\t\t\n\t}\n\n\n}"]],[576,576],[2430,2430]]],[1559729706741,["david@DESKTOP-HUOM822",[[-1,658,"    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n"]],[658,914],[658,658]]],[1559729767183,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,539,"通过网上查资料，发现是由于 "],[-1,558,"301 Moved Perm"],[1,2180,"301 Moved Perm"],[-1,5623,"ginx配置Https证书后"]],[12,12],[5623,5623]]],[1559729767183,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,539,"通过网上查资料，发现是由于 "],[1,572,"301 Moved Perm"],[-1,2180,"301 Moved Perm"],[1,5637,"ginx配置Https证书后"]],[5623,5623],[12,12]]],[1559729708686,["david@DESKTOP-HUOM822",[[-1,658,"\n"]],[659,659],[658,658]]],[1559729709132,["david@DESKTOP-HUOM822",[[-1,657,"\n"]],[658,658],[657,657]]],[1559729714924,["david@DESKTOP-HUOM822",[[-1,681,"    #tcp_nopush     on;\n\n    #keepalive_timeout  0;"]],[681,732],[681,681]]],[1559729715508,["david@DESKTOP-HUOM822",[[-1,681,"\n"]],[681,681],[680,680]]],[1559729717788,["david@DESKTOP-HUOM822",[[-1,728," "]],[726,726],[725,725]]],[1559729718212,["david@DESKTOP-HUOM822",[[-1,724,"\n"]],[725,725],[724,724]]],[1559729718764,["david@DESKTOP-HUOM822",[[-1,723,"\n"]],[724,724],[723,723]]],[1559729728165,["david@DESKTOP-HUOM822",[[-1,1383,"/ylzhy-api"]],[1393,1393],[1383,1383]]],[1559729737451,["david@DESKTOP-HUOM822",[[-1,1369,"\n"]],[1369,1369],[1368,1368]]],[1559729738613,["david@DESKTOP-HUOM822",[[-1,1369,"\t"]],[1370,1370],[1369,1369]]],[1559729738964,["david@DESKTOP-HUOM822",[[-1,1369,"\n"]],[1369,1369],[1368,1368]]],[1559729741701,["david@DESKTOP-HUOM822",[[-1,1569,"\n"]],[1569,1569],[1568,1568]]],[1559729742966,["david@DESKTOP-HUOM822",[[-1,1565,"\t\t\t"]],[1568,1568],[1565,1565]]],[1559729743412,["david@DESKTOP-HUOM822",[[-1,1565,"\n"]],[1565,1565],[1564,1564]]],[1559729757340,["david@DESKTOP-HUOM822",[[-1,2090,"\t\t"]],[2092,2092],[2090,2090]]],[1559729757515,["david@DESKTOP-HUOM822",[[-1,2090,"\n"]],[2090,2090],[2089,2089]]],[1559729757676,["david@DESKTOP-HUOM822",[[-1,2089,"\n"]],[2089,2089],[2088,2088]]],[1559729758003,["david@DESKTOP-HUOM822",[[-1,2088,"\n"]],[2088,2088],[2087,2087]]],[1559729762049,["david@DESKTOP-HUOM822",[[1,2087," ###就是"]],[2087,2087],[2093,2093]]],[1559729762588,["david@DESKTOP-HUOM822",[[-1,2091,"就是"]],[2093,2093],[2091,2091]]],[1559729763765,["david@DESKTOP-HUOM822",[[1,2091,"代码"]],[2091,2091],[2093,2093]]],[1559729765380,["david@DESKTOP-HUOM822",[[-1,2091,"代码"]],[2093,2093],[2091,2091]]],[1559729766788,["david@DESKTOP-HUOM822",[[1,2040," "]],[2040,2040],[2041,2041]]],[1559729827181,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,539,"通过网上查资料，发现是由于 "],[-1,558,"301 Moved Perm"],[1,2105,"301 Moved Perm"],[-1,5548,"ginx配置Https证书后"]],[12,12],[5548,5548]]],[1559729827181,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,539,"通过网上查资料，发现是由于 "],[1,572,"301 Moved Perm"],[-1,2105,"301 Moved Perm"],[1,5562,"ginx配置Https证书后"]],[5548,5548],[12,12]]],[1559729772443,["david@DESKTOP-HUOM822",[[-1,1995,"\t\t#rewrite ^(.*)$  https://$host$1 permanent; "]],[1995,2041],[1995,1995]]],[1559729772931,["david@DESKTOP-HUOM822",[[-1,1995,"\n"]],[1995,1995],[1994,1994]]],[1559729774949,["david@DESKTOP-HUOM822",[[1,1994,"##"]],[1994,1994],[1996,1996]]],[1559729775619,["david@DESKTOP-HUOM822",[[-1,1995,"#"]],[1996,1996],[1995,1995]]],[1559729778749,["david@DESKTOP-HUOM822",[[1,1995,"就"]],[1995,1995],[1996,1996]]],[1559729779027,["david@DESKTOP-HUOM822",[[-1,1995,"就"]],[1996,1996],[1995,1995]]],[1559729785304,["david@DESKTOP-HUOM822",[[1,1995,"这种写法是错误的"]],[1995,1995],[2003,2003]]],[1559729788237,["david@DESKTOP-HUOM822",[[1,2054,"改为307"]],[2054,2054],[2059,2059]]],[1559729887182,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,539,"通过网上查资料，发现是由于 "],[-1,558,"301 Moved Perm"],[1,2072,"301 Moved Perm"],[-1,5515,"ginx配置Https证书后"]],[12,12],[5515,5515]]],[1559729887182,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,539,"通过网上查资料，发现是由于 "],[1,572,"301 Moved Perm"],[-1,2072,"301 Moved Perm"],[1,5529,"ginx配置Https证书后"]],[5515,5515],[12,12]]],[1559729841587,["david@DESKTOP-HUOM822",[[-1,2447,"下面配置80与443共存：\n\n需要配置在一个server里面，443端口后面加ssl。注释掉 ssl on;，具体如下：\n\n```bash\nserver{\n        listen 80;\n        listen 443 ssl;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        #ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n两个server的写法：\n\n```bash\nserver{\n        listen 80;\n        server_name testapp.***.com;\n        rewrite ^(.*) https://$server_name$1 permanent;\n}\n\nserver{\n        listen 443;\n        server_name testapp.***.com;\n        root /data/vhost/test-app;\n        index index.html index.htm index.shtml index.php;\n\n        ssl on;\n        ssl_certificate      /usr/local/nginx/https/***.crt;\n        ssl_certificate_key  /usr/local/nginx/https/***.key;\n        ssl_session_timeout  5m;\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;\n        ssl_prefer_server_ciphers on\n        ssl_session_cache shared:SSL:10m;\n        error_page  404     /404.html;\n\n        location ~ [^/]\\.php(/|$) {\n            fastcgi_index index.php;\n            include fastcgi.conf;\n            fastcgi_pass   127.0.0.1:9000;\n            #include        fastcgi_params;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        }\n       access_log  /data/logs/nginx/access.log  access;\n       error_log  /data/logs/nginx/error.log  crit;\n}\n```\n\n献上ssl优化，以下可以根据业务来使用，不必全部配置，一般配置红色的部分就行了\n\nssl on;\n\n`ssl_certificate   /usr/local/https/www.localhost.com.crt;`\n\n`ssl_certificate_key  /usr/local/https/www.localhost.com.key;`\n\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;  #只允许TLS协议\nssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;#加密套件,这里用了CloudFlare's Internet facing SSL cipher configuration\nssl_prefer_server_ciphers on;  #由服务器协商最佳的加密算法\n\nssl_session_cache builtin:1000 shared:SSL:10m;#Session Cache，将Session缓存到服务器，这可能会占用更多的服务器资源\nssl_session_tickets on;  #开启浏览器的Session Ticket缓存\nssl_session_timeout 10m;  #SSL session过期时间\nssl_stapling on; #OCSP Stapling开启,OCSP是用于在线查询证书吊销情况的服务，使用OCSP Stapling能将证书有效状态的信息缓存到服务器，提高TLS握手速度\nssl_stapling_verify on;  #OCSP Stapling验证开启\nresolver 8.8.8.8 8.8.4.4 valid=300s;  #用于查询OCSP服务器的\nDNSresolver_timeout 5s;  #查询域名超时时间"]],[2447,5538],[2447,2447]]],[1559729845675,["david@DESKTOP-HUOM822",[[-1,2282,"\n"]],[2282,2282],[2281,2281]]],[1559729850499,["david@DESKTOP-HUOM822",[[-1,2226,"从上面我们可以看出，301跳转是永久重定向，而307是临时重定向。这就是301跳转与307跳转两者之间的区别 \n上面可能看的不是很懂，简单直白的表述一下区别：\n\nreturn 307 https://$server_name$request_uri; \n\n307：对于 POST 请求，表示请求还没有被处理，客户端应该向 Location 里的 URI 重新发起 POST 请求\n\n换成 307 状态码即可强制要求不能更改之前的方法。 "]],[2226,2444],[2226,2226]]],[1559729851043,["david@DESKTOP-HUOM822",[[-1,2227,"\n"]],[2226,2226],[2225,2225]]],[1559729851619,["david@DESKTOP-HUOM822",[[-1,2226,"\n"]],[2225,2225],[2224,2224]]],[1559729861595,["david@DESKTOP-HUOM822",[[-1,539,"通过网上查资料，"]],[547,547],[539,539]]],[1559729862804,["david@DESKTOP-HUOM822",[[1,539,"bai"]],[539,539],[542,542]]],[1559729863643,["david@DESKTOP-HUOM822",[[-1,539,"bai"]],[542,542],[539,539]]],[1559729871164,["david@DESKTOP-HUOM822",[[1,539,"查找相关资料后, "]],[539,539],[548,548]]],[1559729874451,["david@DESKTOP-HUOM822",[[-1,570,"。"]],[571,571],[570,570]]],[1559729917558,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,548,"发现是由于 301引起的。换"],[-1,556,"。"],[-1,559,"301 Moved Prm"],[1,2072,"301 Moved Perm"],[-1,2212,"从上面我们可以看出，301跳"]],[12,12],[2212,2212]]],[1559729917558,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,548,"发现是由于 301引起的。换"],[1,570,"。"],[1,572,"301 Moved Prm"],[-1,2072,"301 Moved Perm"],[1,2226,"从上面我们可以看出，301跳"]],[2212,2212],[12,12]]],[1559729914845,["david@DESKTOP-HUOM822",[[1,111,"【"]],[111,111],[112,112]]],[1559729915525,["david@DESKTOP-HUOM822",[[-1,111,"【"]],[112,112],[111,111]]],[1559729967117,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,111,"P"],[1,112,"\n"],[-1,209,"请求"],[1,211,"\n\n"],[1,548,"发现是由于 301引起的。换"],[-1,556,"。"],[-1,559,"301 Moved Prm"],[1,2072,"301 Moved Perm"],[-1,2212,"从上面我们可以看出，301跳"]],[12,12],[2212,2212]]],[1559729967117,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,111,"P"],[-1,111,"\n"],[1,209,"请求"],[-1,209,"\n\n"],[-1,548,"发现是由于 301引起的。换"],[1,570,"。"],[1,572,"301 Moved Prm"],[-1,2072,"301 Moved Perm"],[1,2226,"从上面我们可以看出，301跳"]],[2212,2212],[12,12]]],[1559729931373,["david@DESKTOP-HUOM822",[[1,111,"[Nginx配置Https证书](http://nilaile.win/2019/05/13/Centos7.5%E9%85%8D%E7%BD%AEHTTPS%E8%AF%81%E4%B9%A6/)"]],[111,111],[210,210]]],[1559729938493,["david@DESKTOP-HUOM822",[[1,111,"【"]],[111,111],[112,112]]],[1559729947567,["david@DESKTOP-HUOM822",[[1,128,"】"]],[128,128],[129,129]]],[1559729952420,["david@DESKTOP-HUOM822",[[-1,128,"】"]],[129,129],[128,128]]],[1559729954092,["david@DESKTOP-HUOM822",[[-1,111,"【"]],[112,112],[111,111]]],[1559729955518,["david@DESKTOP-HUOM822",[[1,111,"（"]],[111,111],[112,112]]],[1559729957957,["david@DESKTOP-HUOM822",[[1,128,"）"]],[128,128],[129,129]]],[1559729959312,["david@DESKTOP-HUOM822",[[-1,128,"）"]],[129,129],[128,128]]],[1559729962148,["david@DESKTOP-HUOM822",[[-1,111,"（"]],[112,112],[111,111]]],[1559730027120,[null,[[-1,12,"\ncategories: "],[1,25,"ginx配置Https证书"],[-1,48,"具\n\ntag"],[1,54,"\ncategorie"],[-1,56,"\n-"],[-1,59,"图床"],[-1,67,"---\n\n# ng"],[1,76,"\ntags:\n- "],[-1,81,"http强制"],[1,87,"\n---\n\n"],[-1,210,"P"],[1,211,"\n"],[-1,308,"请求"],[1,310,"\n\n"],[1,647,"发现是由于 301引起的。换"],[-1,655,"。"],[-1,658,"301 Moved Prm"],[1,2171,"301 Moved Perm"],[-1,2311,"从上面我们可以看出，301跳"]],[12,12],[2311,2311]]],[1559730027120,[null,[[1,12,"\ncategories: "],[-1,12,"ginx配置Https证书"],[1,48,"具\n\ntag"],[-1,48,"\ncategorie"],[1,60,"\n-"],[1,61,"图床"],[1,67,"---\n\n# ng"],[-1,67,"\ntags:\n- "],[1,81,"http强制"],[-1,81,"\n---\n\n"],[1,210,"P"],[-1,210,"\n"],[1,308,"请求"],[-1,308,"\n\n"],[-1,647,"发现是由于 301引起的。换"],[1,669,"。"],[1,671,"301 Moved Prm"],[-1,2171,"301 Moved Perm"],[1,2325,"从上面我们可以看出，301跳"]],[2311,2311],[12,12]]],[1559729974986,["david@DESKTOP-HUOM822",[[-1,96,"ttp转Https跳转"]],[107,107],[96,96]]],[1559729981724,["david@DESKTOP-HUOM822",[[1,96,"ttps证书，q"]],[96,96],[104,104]]],[1559729982115,["david@DESKTOP-HUOM822",[[-1,103,"q"]],[104,104],[103,103]]],[1559729982565,["david@DESKTOP-HUOM822",[[1,103,"zhq"]],[103,103],[106,106]]],[1559729983258,["david@DESKTOP-HUOM822",[[-1,103,"zhq"]],[106,106],[103,103]]],[1559729989718,["david@DESKTOP-HUOM822",[[1,103,"之前的博客是"]],[103,103],[109,109]]],[1559729991987,["david@DESKTOP-HUOM822",[[-1,109,"可以"]],[111,111],[109,109]]],[1559729993659,["david@DESKTOP-HUOM822",[[-1,109,"参考"]],[111,111],[109,109]]],[1559729995692,["david@DESKTOP-HUOM822",[[1,109,": "]],[109,109],[111,111]]],[1559730001021,["david@DESKTOP-HUOM822",[[1,214,"an"]],[213,213],[215,215]]],[1559730001701,["david@DESKTOP-HUOM822",[[-1,213,"an"]],[215,215],[213,213]]],[1559730002942,["david@DESKTOP-HUOM822",[[1,213,"安装"]],[213,213],[215,215]]],[1559730004243,["david@DESKTOP-HUOM822",[[-1,213,"安装"]],[215,215],[213,213]]],[1559730006312,["david@DESKTOP-HUOM822",[[1,213,"按照"]],[213,213],[215,215]]],[1559730007395,["david@DESKTOP-HUOM822",[[-1,213,"按照"]],[215,215],[213,213]]],[1559730010747,["david@DESKTOP-HUOM822",[[1,213,"Httpszheng"]],[213,213],[223,223]]],[1559730011931,["david@DESKTOP-HUOM822",[[-1,217,"szheng"]],[223,223],[217,217]]],[1559730019740,["david@DESKTOP-HUOM822",[[1,217,"s证书配置完成后 "]],[217,217],[226,226]]]],null,"david@DESKTOP-HUOM822"]]}