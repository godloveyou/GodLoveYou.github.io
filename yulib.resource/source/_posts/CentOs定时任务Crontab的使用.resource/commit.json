{"compress":true,"commitItems":[["2f7676c8-3255-4f9c-ad71-c6d971c67e9f",1565148202055,"---\ntitle: Lorem ipsum\n---\n\n# Lorem ipsum\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit.\n\n![Praesent accumsan ipsum sit]($appres/images/building.jpg)\n\nPhasellus eu tempor dolor. Nulla hendrerit convallis purus et elementum. Suspendisse non magna vel justo tincidunt finibus. Nullam dui erat, malesuada eget viverra non, finibus a nisl.",[[1565148151299,["david@DESKTOP-9844NL4",[[-1,0,"---\ntitle: Lorem ipsum\n---"]],[0,26],[0,0]]],[1565148151778,["david@DESKTOP-9844NL4",[[1,0,"---\ntitle: java面试系列问题(4)\ncategories: java\n\ntags:\n- 面试\n---"]],[0,0],[57,57]]],[1565148177289,["david@DESKTOP-9844NL4",[[-1,59,"# Lorem ipsum"],[-1,73,"\nLorem ipsum dolor sit amet, consectetur adipiscing elit.\n\n![Praesent accumsan ipsum sit]($appres/images/building.jpg)\n\nPhasellus eu tempor dolor. Nulla hendrerit convallis purus et elementum. Suspendisse non magna vel justo tincidunt finibus. Nullam dui erat, malesuada eget viverra non, finibus a nisl."]],[59,377],[59,59]]],[1565148177682,["david@DESKTOP-9844NL4",[[1,60,"\n# CentOs定时任务Crontab的使用\n\n>  Linux crontab是用来定期执行程序的命令。当安装完成操作系统之后，默认便会启动此任务调度命令。crond命令每分锺会定期检查是否有要执行的工作，如果有要执行的工作便会自动执行该工作。\n\n\n## linux任务调度的工作主要分为以下两类：\n\n- 1、系统执行的工作：系统周期性所要执行的工作，如备份系统数据、清理缓存\n- 2、个人执行的工作：某个用户定期要做的工作，例如每隔10分钟检查邮件服务器是否有新信，这些工作可由每个用户自行设置\n\n## 语法\ncrontab [ -u user ] file\n或\ncrontab [ -u user ] { -l | -r | -e }\n\n## 参数说明\n* -u user：用来设定某个用户的crontab服务,这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设定自己的时程表。\n\n* file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab\n\n* -e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。\n* -l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。\n\n* -r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件.\n\n## crontab的文件格式\n![mark](http://blog.sjjtcloud.com/blog/20190806/6dVEtGXqD2FO.png?imageslim)\n\n\n\n分 时 日 月 星期 要运行的命令\n\n第1列分钟0～59\n第2列小时0～23（0表示子夜）\n第3列日1～31\n第4列月1～12\n第5列星期0～7（0和7表示星期天）\n第6列要运行的命令\n\n## 常用方法\n\n列出crontab文件\n`$ crontab -l `\n\n编辑crontab文件\n`$ crontab -e`\n可以像使用vi编辑其他任何文件那样修改crontab文件并退出。如果修改了某些条目或添加了新的条目，那么在保存该文件时， cron会对其进行必要的完整性检查。如果其中的某个域出现了超出允许范围的值，它会提示你。 我们在编辑crontab文件时，没准会加入新的条目\n\n删除crontab文件\n`$crontab -r`\n\n注解\n最好在crontab文件的每一个条目之上加入一条注释，这样就可以知道它的功能、运行时间，更为重要的是，知道这是哪位用户的定时作业。\n\n```\n实例1：每1分钟执行一次myCommand\n * * * myCommand\n\n实例2：每小时的第3和第15分钟执行\n\t3,15 * * * * myCommand\n\t\n实例3：在上午8点到11点的第3和第15分钟执行\n\t3,15 8-11 * * * myCommand\n\n实例4：每隔两天的上午8点到11点的第3和第15分钟执行\n\t3,15 8-11 */2  *  * myCommand\n\n实例5：每周一上午8点到11点的第3和第15分钟执行\n\t3,15 8-11 * * 1 myCommand\n\n实例6：每晚的21:30重启smb\n\t30 21 * * * /etc/init.d/smb restart\n\n实例7：每月1、10、22日的4 : 45重启smb\n\t45 4 1,10,22 * * /etc/init.d/smb restart\n\n实例8：每周六、周日的1 : 10重启smb\n\t10 1 * * 6,0 /etc/init.d/smb restart\n\n实例9：每天18 : 00至23 : 00之间每隔30分钟重启smb\n\t0,30 18-23 * * * /etc/init.d/smb restart\n\n实例10：每星期六的晚上11 : 00 pm重启smb\n\t0 23 * * 6 /etc/init.d/smb restart\n\n实例11：每一小时重启smb\n\t* */1 * * * /etc/init.d/smb restart\n\n实例12：晚上11点到早上7点之间，每隔一小时重启smb\n\t0 23-7 * * * /etc/init.d/smb restart\n\n```\n\n\n## 案例(每2分钟执行一次test.sh中脚本)\n```\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\nHOME=/\n\n*/2 * * * * sh /home/backup/test.sh\n\n```\n### 查看cron执行的日志\n```\nvim /var/log/cron 看到如下记录日志,发现linux在执行任务后向管理员发送了邮件,但是这个邮件没有发送成功\n```\n\n```\nAug  6 10:44:01 iZ3i4n96yv24gsZ CROND[2868]: (root) CMD (sh /home/backup/test.sh)\nAug  6 10:44:01 iZ3i4n96yv24gsZ CROND[2867]: (root) MAIL (mailed 2802 bytes of output but got status 0x004b#012)\nAug  6 10:45:01 iZ3i4n96yv24gsZ CROND[3976]: (root) CMD (sh /home/backup/test.sh)\nAug  6 10:45:01 iZ3i4n96yv24gsZ CROND[3975]: (root) MAIL (mailed 2802 bytes of output but got status 0x004b#012)\nAug  6 10:46:01 iZ3i4n96yv24gsZ CROND[5031]: (root) CMD (sh /home/backup/test.sh)\nAug  6 10:46:01 iZ3i4n96yv24gsZ CROND[5030]: (root) MAIL (mailed 2802 bytes of output but got status 0x004b#012)\n```\n\n###　问题：如果想要查看详细的任务执行日志,要查看登录用户的邮箱,本地测试时使用的root用户, 查看发现无root用户的任何邮件\n\n### 解決方式\n1. 查看mail的发送日志 `vim /var/log/maillog`  原因是 parameter inet_interfaces: no local interface found for ::1\n```\n\nAug  6 10:42:01 iZ3i4n96yv24gsZ postfix/sendmail[584]: fatal: parameter inet_interfaces: no local interface found for ::1\nAug  6 10:43:01 iZ3i4n96yv24gsZ postfix/sendmail[1817]: fatal: parameter inet_interfaces: no local interface found for ::1\nAug  6 10:44:01 iZ3i4n96yv24gsZ postfix/sendmail[2870]: fatal: parameter inet_interfaces: no local interface found for ::1\nAug  6 10:45:01 iZ3i4n96yv24gsZ postfix/sendmail[3978]: fatal: parameter inet_interfaces: no local interface found for ::1\nAug  6 10:46:01 iZ3i4n96yv24gsZ postfix/sendmail[5033]: fatal: parameter inet_interfaces: no local interface found for ::1\n\n```\n\n2. 通过google发现解决方式为\n\n   ```xml\n   vi  /etc/postfix/main.cf\n   发现配置为：\n   inet_interfaces = localhost\n   inet_protocols = all\n   \n   改成：\n   inet_interfaces = all\n   \n   inet_protocols = all\n   \n   \n   重新启动\n   service postfix start\n   \n   ```\n\n3. 再等待一个周期后,收到了定时任务推送的邮件,查看邮件内容,一切正常\n"]],[59,59],[3885,3885]]],[1565148181705,["david@DESKTOP-9844NL4",[[-1,63,"CentOs定时任务Crontab的使用"]],[63,83],[63,63]]],[1565148184354,["david@DESKTOP-9844NL4",[[-1,11,"java面试系列问题(4)"],[1,24,"CentOs定时任务Crontab的使用"]],[11,24],[31,31]]],[1565148186100,["david@DESKTOP-9844NL4",[[-1,44,"java"],[1,48,"L"]],[44,44],[45,45]]],[1565148187139,["david@DESKTOP-9844NL4",[[1,45,"INUX"]],[45,45],[49,49]]],[1565148189394,["david@DESKTOP-9844NL4",[[-1,61,"\n"]],[61,62],[61,61]]],[1565148189633,["david@DESKTOP-9844NL4",[[-1,60,"试"]],[61,61],[60,60]]],[1565148190586,["david@DESKTOP-9844NL4",[[1,60,"试"]],[60,60],[61,61]]],[1565148190954,["david@DESKTOP-9844NL4",[[1,61,"\n"]],[61,61],[61,62]]],[1565148194482,["david@DESKTOP-9844NL4",[[-1,58," 面试"]],[61,61],[58,58]]],[1565148196192,["david@DESKTOP-9844NL4",[[1,58," 面试"]],[58,58],[61,61]]],[1565148197129,["david@DESKTOP-9844NL4",[[-1,59,"面试"]],[61,61],[59,59]]],[1565148198802,["david@DESKTOP-9844NL4",[[1,59,"CR"]],[59,59],[61,61]]],[1565148199482,["david@DESKTOP-9844NL4",[[-1,59,"CR"]],[61,61],[59,59]]],[1565148201692,["david@DESKTOP-9844NL4",[[1,59,"cront"]],[59,59],[64,64]]],[1565148202123,["david@DESKTOP-9844NL4",[[1,64,"b"]],[64,64],[65,65]]],[1565148202553,["david@DESKTOP-9844NL4",[[-1,64,"b"]],[65,65],[64,64]]],[1565148202866,["david@DESKTOP-9844NL4",[[1,64,"ab"]],[64,64],[66,66]]],[1565148206945,["david@DESKTOP-9844NL4",[[-1,50,"\n"]],[50,50],[49,49]]],[1565148211953,["david@DESKTOP-9844NL4",[[-1,73,"# \n"]],[73,76],[73,73]]],[1565148212385,["david@DESKTOP-9844NL4",[[-1,73,"\n"]],[73,73],[72,72]]],[1565148212738,["david@DESKTOP-9844NL4",[[-1,72,"\n"]],[72,72],[71,71]]],[1565148213146,["david@DESKTOP-9844NL4",[[-1,71,"\n"]],[71,71],[70,70]]],[1565148223437,["david@DESKTOP-9844NL4",[[1,80,"下的定时"]],[80,80],[84,84]]],[1565148225298,["david@DESKTOP-9844NL4",[[-1,81,"的定时"]],[84,84],[81,81]]],[1565148226379,["david@DESKTOP-9844NL4",[[1,81,"通过"]],[81,81],[83,83]]],[1565148230129,["david@DESKTOP-9844NL4",[[-1,90,"是用"]],[92,92],[90,90]]],[1565148234720,["david@DESKTOP-9844NL4",[[-1,91,"定期执行程序的命令。"]],[101,101],[91,91]]],[1565148240475,["david@DESKTOP-9844NL4",[[1,91,"执行定时任务,"]],[91,91],[98,98]]],[1565148247546,["david@DESKTOP-9844NL4",[[1,70,"="]],[70,70],[71,71]]],[1565148247567,["david@DESKTOP-9844NL4",[[-1,70,"="]],[71,71],[70,70]]],[1565148247857,["david@DESKTOP-9844NL4",[[-1,70,"\n"]],[70,70],[69,69]]],[1565148254265,["david@DESKTOP-9844NL4",[[-1,368," "]],[369,369],[368,368]]],[1565148254811,["david@DESKTOP-9844NL4",[[1,368," "]],[368,368],[369,369]]],[1565149902895,["david@DESKTOP-9844NL4",[[1,856,"<!-- more -->"]],[856,856],[869,869]]]],null,"david@DESKTOP-9844NL4"]]}